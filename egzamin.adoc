=== Import danych do bazy
Korzystam z danych REDDIT już zaimportowanych do bazy MongoDB i opisanych pod linkiem: https://github.com/leyas/NoSQL/blob/master/zaliczenie.adoc.

Zaimportowano 53 851 542 rekordów.

image::http://s3.postimg.org/7hu3ldo0z/8import_result.png[import result]

=== Wykonanie agregacji

===== 1. Spośród wszystkich wpisów wyszukamy 10 autorów którzy uzyskali najgorszy winik (score) w ciągu ostatniego miesiąca.

Odpowiedź:
```
-8900
-5241
-5043
-3552
-2450
-2410
-2393
-2235
-2183
-2153
```

a) JavaScript 
```
db.myColl.runCommand('aggregate', 
  {pipeline: [
		{ $group: { _id: "$author", score: { $sum: "$score" } } },
		{ $sort: { score: 1 } },
		{ $limit : 10 }
	], 
allowDiskUse: true})
```

b) Java

c) Porównanie JavaScript i Java
|===
| Język | Czas | zużycie CPU | zużycie RAM

| JavaScript
| 14 min
| 20 %
| 99%

| Java
| 
|
|

|===

image::http://s3.postimg.org/7hu3ldo0z/1javascript.png[1javascript]
image::http://s3.postimg.org/7hu3ldo0z/1java.png[1java]

===== 2. Ile średnio polubień dostaje post?

Odpowiedź:
```
~ 5.23
```
a) JavaScript
```
db.myColl.runCommand('aggregate', 
	{pipeline: [
		{ $group: { 
			_id: null, 
			avg: { $avg: "$ups" } 
			} 
		},
	], 
       	allowDiskUse: true})
```
b) Java

c) Porównanie JavaScript i Java

|===
| Język | Czas | zużycie CPU | zużycie RAM

| JavaScript
| 11 min
| 20 %
| 99%

| Java
| 
|
|

|===

===== 3. Ilu jest autorów wpisów ?
Odpowiedź:
```
6 317 738
```
a) JavaScript
```
db.myColl.runCommand('aggregate', 
        {pipeline: [
		{ $group: { 
			_id: "$author", 
			ilu_autorow: { $sum: 1 } 
			} 
		},
	], 
        allowDiskUse: true})
```
b) Java

c) Porównanie JavaScript i Java

|===
| Język | Czas | zużycie CPU | zużycie RAM

| JavaScript
| 16
| 20 %
| 99%

| Java
| 
|
|

|===

===== 4. Ile kobiet pisze wiadomości ?
Odpowiedź:
```
n
```

a) JavaScript
```
db.myColl.aggregate( [
   
	 { $match: { author_flair_text: "Male" } },
	 { $group: {
          _id: null,
		  count: { $sum: 1 }
        }
     }
   
] )
```

b) Java

c) Porównanie JavaScript i Java
|===
| Język | Czas | zużycie CPU | zużycie RAM

| JavaScript
| 
| 10 %
| 99%

| Java
| 
|
|

|===
